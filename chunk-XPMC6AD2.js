import{a as ee,b as te}from"./chunk-MJZW6SHQ.js";import{a as re,b as ne}from"./chunk-FXIXKAG5.js";import{a as Z}from"./chunk-K4VL6BXC.js";import{$a as U,A as T,C as M,D as V,E as k,F as R,H as q,Ka as O,La as z,Wa as A,Xa as L,Ya as B,Za as W,_a as $,ab as H,bb as J,cb as K,db as Q,eb as X,fa as w,g as F,kb as Y,lb as ie,mb as oe,r as D,ra as j,sa as G,w as N,x as d,z as I}from"./chunk-ZOTFAVLD.js";import{Fb as r,Ja as E,Ob as P,Pa as C,S as c,X as u,Y as f,Za as h,_a as y,_b as b,cb as m,db as i,eb as t,ec as v,fb as o,hc as S,mb as x,qb as g,rb as _,xa as a}from"./chunk-J75BIECF.js";function se(n,e){n&1&&(i(0,"span",43),r(1,"CoachAssistant"),t())}function ae(n,e){n&1&&o(0,"p-button",44)}function me(n,e){if(n&1){let l=x();i(0,"p-button",45),g("onClick",function(){u(l);let p=_();return f(p.toggleFullScreen())}),t(),i(1,"p-button",46),g("onClick",function(){u(l);let p=_();return f(p.goCoachees())}),t()}if(n&2){let l=_();m("icon",l.isFullScreen()?"pi pi-window-minimize":"pi pi-window-maximize")}}function de(n,e){n&1&&(i(0,"small",12),r(1,"El tipo es obligatorio."),t())}function ce(n,e){n&1&&(i(0,"small",12),r(1,"La duraci\xF3n es obligatoria."),t())}var le=class n{fullScreenService=c(B);isFullScreen=this.fullScreenService.isFullScreen;toggleFullScreen(){this.fullScreenService.toggle()}router=c(D);fb=c(R);confirmationService=c(w);service=c(Z);id=S.required();coacheeId=S.required();loading=this.service.loading;error=this.service.error;processForm=this.fb.group({id:[{value:null,disabled:!0}],type:["",d.required],duration_minutes:[60,[d.required,d.min(1)]],is_grow:[!1],goal:[""],start_date:[null],end_date:[null],frequency_days:[null,d.min(1)],observations:[""],session_price:[null,d.min(0)],payment_method:[null],payment_term_days:[null,d.min(0)],contract_signed:[!1],lodp_signed:[!1],rgpd_signed:[!1]});constructor(){v(()=>{let e=this.id();this.service.getProcess(e)}),v(()=>{let e=this.service.process();e?this.processForm.patchValue({id:e.id,type:e.type||null,duration_minutes:e.duration_minutes,is_grow:e.is_grow??!1,goal:e.goal,start_date:e.start_date?new Date(e.start_date):null,end_date:e.end_date?new Date(e.end_date):null,frequency_days:e.frequency_days,observations:e.observations,session_price:typeof e.session_price=="string"?parseFloat(e.session_price):e.session_price,payment_method:e.payment_method||null,payment_term_days:e.payment_term_days,contract_signed:e.contract_signed??!1,lodp_signed:e.lodp_signed??!1,rgpd_signed:e.rgpd_signed??!1}):this.processForm.reset()}),v(()=>{let e=this.error();!this.loading()&&e&&this.showErrorDialog(e)})}ngOnDestroy(){this.service.clearProcess()}showErrorDialog(e){this.confirmationService.confirm({message:e,header:"Error",icon:"pi pi-times-circle",rejectLabel:"Cerrar",rejectVisible:!0,acceptVisible:!1})}showWarningDialog(e){this.confirmationService.confirm({message:e,header:"\xA1Atenci\xF3n!",icon:"pi pi-exclamation-triangle",rejectLabel:"Cerrar",rejectVisible:!0,acceptVisible:!1})}onSubmit(){if(this.processForm.markAllAsTouched(),!this.processForm.valid){this.showWarningDialog("El formulario de proceso contiene errores.");return}let e=this.processForm.getRawValue();e.id?this.updateProcess(e.id,e):this.createProcess(this.coacheeId(),e)}createProcess(e,l){this.service.createProcess$(e,l).subscribe({next:()=>{this.router.navigate(["/coachees"])},error:s=>{this.showErrorDialog(s)}})}updateProcess(e,l){this.service.updateProcess$(e,l).subscribe({next:()=>{this.router.navigate(["/coachees"])},error:s=>{this.showErrorDialog(s)}})}goCoachees(){this.router.navigate(["/coachees"])}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=E({type:n,selectors:[["app-process"]],inputs:{id:[1,"id"],coacheeId:[1,"coacheeId"]},features:[P([w])],decls:75,vars:10,consts:[["start",""],["center",""],["end",""],[1,"w-full","h-full","flex","flex-col","gap-2","bg-primary-50"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-x-4","gap-y-2"],[1,"flex","flex-col","gap-2","md:col-span-2","lg:col-span-3"],["for","goal",1,"font-semibold"],["id","goal","type","text","pInputText","","formControlName","goal",1,"w-full"],[1,"flex","flex-col","gap-2"],["for","type",1,"font-semibold"],["id","type","type","text","pInputText","","formControlName","type",1,"w-full"],[1,"text-red-500"],["for","is_grow",1,"font-semibold"],["id","is_grow","formControlName","is_grow",1,"my-2"],["for","duration_minutes",1,"font-semibold"],["id","duration_minutes","formControlName","duration_minutes","suffix"," min","inputStyleClass","w-full",1,"w-full",3,"min"],["for","frequency",1,"font-semibold"],["id","frequency","formControlName","frequency_days","suffix"," d\xEDas","inputStyleClass","w-full",1,"w-full",3,"min"],["for","start_date",1,"font-semibold"],["id","start_date","formControlName","start_date","dateFormat","dd-mm-yy",1,"w-full",3,"showIcon"],["for","end_date",1,"font-semibold"],["id","end_date","formControlName","end_date","dateFormat","dd-mm-yy",1,"w-full",3,"showIcon"],[1,"md:col-span-2","lg:col-span-3"],["for","price",1,"font-semibold"],["id","price","formControlName","session_price","mode","currency","currency","EUR","locale","es-ES","inputStyleClass","w-full",1,"w-full"],["for","payment_method",1,"font-semibold"],["id","payment_method","type","text","pInputText","","formControlName","payment_method",1,"w-full"],["for","payment_term",1,"font-semibold"],["id","payment_term","formControlName","payment_term_days","suffix"," d\xEDas","inputStyleClass","w-full",1,"w-full",3,"min"],["id","documents",1,"flex","flex-col","gap-2","md:col-span-2","lg:col-span-3","p-2","mt-2"],[1,"flex","flex-row","justify-between","gap-2"],[1,"flex","justify-between","items-center","gap-2"],["for","contract_signed",1,"font-semibold"],["id","contract_signed","formControlName","contract_signed"],["for","lodp_signed",1,"font-semibold"],["id","lodp_signed","formControlName","lodp_signed"],["for","rgpd_signed",1,"font-semibold"],["id","rgpd_signed","formControlName","rgpd_signed"],["for","observations",1,"font-semibold"],["id","observations","pInputTextarea","","formControlName","observations","rows","4",1,"w-full",3,"autoResize"],[1,"flex","justify-center","mt-4","gap-4"],["type","submit","label","Guardar Proceso","icon","pi pi-check",3,"disabled"],[1,"pl-3","text-primary","font-medium","text-l"],["icon","pi pi-folder-open","text","","severity","success","label","Datos del Proceso"],["text","","severity","info",3,"onClick","icon"],["icon","pi pi-sign-out","text","","severity","danger",3,"onClick"]],template:function(l,s){if(l&1){let p=x();i(0,"div",3)(1,"p-toolbar"),C(2,se,2,0,"ng-template",null,0,b)(4,ae,1,0,"ng-template",null,1,b)(6,me,2,1,"ng-template",null,2,b),t(),o(8,"p-confirmdialog"),i(9,"form",4),g("ngSubmit",function(){return u(p),f(s.onSubmit())}),i(10,"div",5)(11,"div",6)(12,"label",7),r(13,"Objetivo General"),t(),o(14,"input",8),t(),i(15,"div",9)(16,"label",10),r(17,"Tipo *"),t(),o(18,"input",11),h(19,de,2,0,"small",12),t(),i(20,"div",9)(21,"label",13),r(22,'Proceso "GROW"'),t(),o(23,"p-toggleSwitch",14),t(),i(24,"div",9)(25,"label",15),r(26,"Duraci\xF3n (min) *"),t(),o(27,"p-inputNumber",16),h(28,ce,2,0,"small",12),t(),i(29,"div",9)(30,"label",17),r(31,"Frecuencia (d\xEDas)"),t(),o(32,"p-inputNumber",18),t(),i(33,"div",9)(34,"label",19),r(35,"Fecha Inicio"),t(),o(36,"p-datepicker",20),t(),i(37,"div",9)(38,"label",21),r(39,"Fecha Fin"),t(),o(40,"p-datepicker",22),t(),o(41,"p-divider",23),i(42,"div",9)(43,"label",24),r(44,"Precio Sesi\xF3n"),t(),o(45,"p-inputNumber",25),t(),i(46,"div",9)(47,"label",26),r(48,"M\xE9todo de Pago"),t(),o(49,"input",27),t(),i(50,"div",9)(51,"label",28),r(52,"Plazo Pago (d\xEDas)"),t(),o(53,"p-inputNumber",29),t(),i(54,"p-panel",30)(55,"div",31)(56,"div",32)(57,"label",33),r(58,"Contrato Firmado"),t(),o(59,"p-toggleSwitch",34),t(),i(60,"div",32)(61,"label",35),r(62,"LODP Firmada"),t(),o(63,"p-toggleSwitch",36),t(),i(64,"div",32)(65,"label",37),r(66,"RGPD Firmado"),t(),o(67,"p-toggleSwitch",38),t()()(),o(68,"p-divider",23),i(69,"div",6)(70,"label",39),r(71,"Observaciones"),t(),o(72,"textarea",40),t()(),i(73,"div",41),o(74,"p-button",42),t()()()}l&2&&(a(9),m("formGroup",s.processForm),a(10),y(s.processForm.controls.type.invalid&&s.processForm.controls.type.touched?19:-1),a(8),m("min",1),a(),y(s.processForm.controls.duration_minutes.invalid&&s.processForm.controls.duration_minutes.touched?28:-1),a(4),m("min",1),a(4),m("showIcon",!0),a(4),m("showIcon",!0),a(13),m("min",0),a(19),m("autoResize",!0),a(2),m("disabled",s.processForm.invalid))},dependencies:[F,q,M,N,I,T,V,k,G,j,X,Q,K,J,z,O,H,U,ne,re,Y,te,ee,oe,ie,$,W,L,A],encapsulation:2})};export{le as Process};
