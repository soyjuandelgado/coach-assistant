<div class="w-full h-full flex flex-col gap-2 bg-primary-50">
    <p-toolbar>
        <ng-template #start>
            <span class="pl-3 text-primary font-medium text-l">CoachAssistant</span>
        </ng-template>
        <ng-template #center>
            <p-button icon="pi pi-users" text severity="help" label="Coachees" />
        </ng-template>
        <ng-template #end>
            <p-button icon="pi pi-window-maximize" text severity="info" (onClick)="toggleFullScreen()" />
            <p-button icon="pi pi-power-off" text severity="danger" (onClick)="closeSession()" />
        </ng-template>
    </p-toolbar>
    <p-confirmdialog />
    <app-new-session-dialog [(visible)]="visibleNewSession" [processId]="selectedProcessId()"></app-new-session-dialog>
    <div class="w-full flex flex-col">
        <p-popover #cp>
            <ng-template #content>
                <h4 class="font-medium">¿Qué hace cada botón?</h4>
                <p-divider />
                <ul class="list-inside list-none gap-1">
                    <li><span class="pi pi-window-maximize text-blue-500 pr-3"></span>Pantalla completa</li>
                    <li><span class="pi pi-power-off text-red-500 pr-3"></span>Salir</li>
                    <p-divider />
                    <li><span class="pi pi-id-card text-blue-500 pr-3"></span>Ver perfil del coachee</li>
                    <li><span class="pi pi-folder-open text-orange-500 pr-3"></span>Ver datos del proceso</li>
                    <li><span class="pi pi-file-plus text-green-500 pr-3"></span>Crear nueva sesión</li>
                    <li><span class="pi pi-folder-plus text-purple-500 pr-3"></span>Crear nuevo resumen</li>
                    <li><span class="pi pi-trash text-red-500 pr-3"></span>Eliminar coachee</li>
                </ul>
            </ng-template>
        </p-popover>

        <label for="coachees" class="block mb-1 font-medium">Coachees activos <p-button icon="pi pi-info-circle" text
                severity="info" [size]="'small'" (click)="cp.toggle($event)" /></label>
        <p-table [value]="coachees()" [selectionMode]=null dataKey="id" scrollHeight="flex" id="coachee"
            [size]="'small'" disabled>
            <ng-template #header>
                <tr>
                    <th [width]="'60%'">Nombre</th>
                    <th>Acciones</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-coachee>
                <tr [pSelectableRow]="coachee">
                    <td>{{ coachee.name + " " + coachee.surname + (coachee.middlename ? " " + coachee.middlename : "")
                        }}
                    </td>
                    <td>
                        <p-button icon="pi pi-id-card" text severity="info" tooltip="Ver perfil"
                            [routerLink]="['/coachee', coachee.id]" />
                        @if(coachee.processes && coachee.processes.length > 0 ){
                        <p-button icon="pi pi-folder-open" text severity="warn" tooltip="Ver proceso"
                            [routerLink]="['/process', coachee.id, coachee.processes[0].id]" />
                        }@else{
                        <p-button icon="pi pi-folder-open" text severity="warn" tooltip="Ver proceso"
                            [disabled]="true" />
                        }
                        <p-button icon="pi pi-file-plus" text severity="success" tooltip="Nueva Sesión"
                            (onClick)="showNewSession(coachee.processes)"
                            [disabled]="!coachee.processes || coachee.processes.length === 0" />
                        <p-button icon="pi pi-folder-plus" text severity="help" tooltip="Nuevo Resumen"
                            (onClick)="goSummary()" [disabled]="!coachee.processes || coachee.processes.length === 0" />
                        <p-button icon="pi pi-history" text severity="secondary" tooltip="Ver historial"
                            [disabled]="!coachee.processes || coachee.processes.length === 0" [hidden]="true" />
                        <p-button icon="pi pi-trash" text severity="danger" tooltip="Eliminar Coachee"
                            (onClick)="showRemoveDialog($event, coachee.id)" />
                    </td>
                </tr>
            </ng-template>
        </p-table>
        <p-button class="self-center pt-3" icon="pi pi-user-plus" severity="info" label="Nuevo Coachee"
            tooltip="Nuevo Coachee" [routerLink]="['/coachee', '']" />
    </div>