<p-confirmdialog />
<app-coachee-profile [coachee]="this.coachee()" [(visible)]="this.visibleProfile"></app-coachee-profile>
<app-previous-info-dialog [process]="this.process()" [(visible)]="this.visibleNotes"></app-previous-info-dialog>
<app-emotions-dialog [(visible)]="this.visibleEmotions" (emotionClicked)="addEmotion($event)"></app-emotions-dialog>
<app-lesson-dialog [(visible)]="this.visibleLesson" [imageSrc]="this.lessonImage()"></app-lesson-dialog>
<app-session-drawer [(visible)]="visible" (leaveSession)="leaveSession($event)" (showDialogEmotions)="showDialogEmotions()" (showDialogLesson)="showDialogLesson($event)" (showProfile)="showProfile()"></app-session-drawer>
<div class="w-full h-full flex flex-col gap-2 bg-primary-50">
    <p-toolbar [style]="{ 'padding': '0' }">
        <ng-template #start>
            <p-button icon="pi pi-bars" text severity="contrast" (click)="visible = true" />
        </ng-template>
        <ng-template #center>
            <p-button id="title" icon="pi pi-folder-open" text severity="warn"
                label="{{this.process() ? (this.coachee() ? this.coachee()!.name + ' ' + this.coachee()!.surname  : '' ) : ''}} - Sesión {{this.session()?.session_number}}"
                (click)="showDialogNotes()" />
            <p-button icon="pi pi-stopwatch" label="{{this.session()?.duration_minutes}}'" severity="success"
                variant="text" />
        </ng-template>
        <ng-template #end>
            <p-button icon="pi pi-window-maximize" text severity="info" (onClick)="toggleFullScreen()" />
            <p-button icon="pi pi-sign-out" text severity="danger" (onClick)="leaveSession($event)" />
        </ng-template>
    </p-toolbar>
    <section class="w-full">
        <p-popover #op>
            <ng-template #content>
                <h4 class="font-medium pb-1">Definición de Objetivo</h4>
                <ul class="list-inside list-disc">
                    <li>M - Medible</li>
                    <li>A - Alcanzable</li>
                    <li>R - Realista</li>
                    <li>T - Definido en el Tiempo</li>
                    <li>E - Específico</li>
                    <li>S - Satisfactorio</li>
                </ul>
            </ng-template>
        </p-popover>
        <p-panel>
            <ng-template #header>
                <span class="font-medium">Objetivo</span>
            </ng-template>
            <span>{{this.goal() ? this.goal() : '- No definido -'}}</span>
            <ng-template #icons>
                <p-button icon="pi pi-info-circle" text severity="info" [size]="'small'" (click)="op.toggle($event)" />
            </ng-template>
        </p-panel>
    </section>
    <section class="w-full flex flex-col">
        <p-panel>
            <ng-template #header>
                <span class="font-medium">Desarrollo de la sesión</span>
            </ng-template>
            <ul class="max-h-115 overflow-y-auto">
                @for (note of notes(); track $index) {
                <li>
                    {{note}}
                </li>
                }
            </ul>
            <ng-template #icons>
                <p-button icon="pi pi-info-circle" text severity="info" [size]="'small'" />
            </ng-template>
        </p-panel>
    </section>
    <section class="w-full mb-auto">
        <p-panel>
            <ng-template #header>
                <span class="font-medium">Planes de Acción</span>
            </ng-template>
            <ul>
                @for (task of tasks(); track $index) {
                <li>
                    {{task}}
                </li>
                }
            </ul>
            <ng-template #icons>
                <p-button icon="pi pi-info-circle" text severity="info" [size]="'small'" />
            </ng-template>
        </p-panel>
    </section>
    <app-insert-data [is_grow]="this.session()?.is_grow ?? false" (newGoal)="setGoal($event)"
        (newNote)="addNote($event)" (newTask)="addTask($event)">
    </app-insert-data>
</div>